<?php

session_start();

require('../fpdf.php');

include '../../../connection.php';
include '../../../connection2.php';

$_item = mysqli_query($connection, "SELECT * FROM client WHERE clientId = '" . $_GET["id"] . "'"); $data = $_item -> fetch_object(); $_country = mysqli_query($master, "SELECT * FROM country WHERE countryId = '" . $data -> countryId . "'"); $country = $_country -> fetch_object(); $_economicArea = mysqli_query($master, "SELECT * FROM economicarea WHERE economicAreaId = '" . $data -> economicAreaId . "'"); $economicArea = $_economicArea -> fetch_object(); $_status = mysqli_query($master, "SELECT * FROM status WHERE statusId = '" . $data -> statusId . "'"); $status = $_status -> fetch_object(); $_risk = mysqli_query($master, "SELECT * FROM risk WHERE riskId = '" . $data -> riskId . "'"); $risk = $_risk -> fetch_object();

class PDF extends FPDF {

    function Header() {
        $this -> SetTitle('Reportes'); $this -> Image('../../../images/logo.png', 10, 10, 45); $this -> SetFont('Arial', 'IB', 13); $this -> Cell(45, 10, '', 0, 0, ''); $this -> Cell(150, 12, utf8_decode('Módulo: Clientes'), 0, 0, 'R'); $this -> Ln(20); $this -> SetFont('Arial','I',8); $this -> Cell(195, 5, utf8_decode('Tabla Clientes'), 0, 0, ''); $this -> Ln(); $this -> Cell(97.5, 5, utf8_decode('Administradores/Auditoría Externa'), 0, 0, ''); $this -> Cell(97.5, 5, 'Fecha: ' . date('d/m/Y'), 0, 0, 'R'); $this -> SetY(50); $this -> Line(10, 45, 205, 45);
    }

    function Footer() {
        $this -> SetY(-10); $this -> SetFont('Arial', 'I', 7); $this -> Cell(150, 5, utf8_decode('Reporte emitido por el Sistema SagraGP para fines de consulta.'), 0, 0, ''); $this -> Cell(45, 5, utf8_decode('Página') . ' ' .$this -> PageNo().' de {nb}', 0, 0, 'R'); $this -> Line(10, 267, 205, 267);
    }
}

$pdf = new PDF(); $pdf -> AddPage(); $pdf -> AliasNbPages(); if ($data) { $pdf -> AddFont('Ubuntu', '', 'Ubuntu-Light.php'); $pdf -> SetDrawColor(150, 150, 150); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, 'Nombre: '); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientName), ''); $pdf -> Ln(10); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, 'Nit: '); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientNit), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Dirección: '), ''); $pdf -> SetFont('Arial', 'B', 9); $pdf -> MultiCell(165, 6, utf8_decode($data -> clientAddress), '', '', ''); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Ciudad: '), ''); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientCity), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('País: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($country -> countryName), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Zona Postal: '), ''); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientZipCode), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Persona Contacto: '), ''); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientContact), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Teléfono 1: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientPhone1), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Teléfono 2: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientPhone2), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Correo Electrónico: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientEmail), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Página Web: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientWebPage), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Observaciones: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientObservations), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Area Económica: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($economicArea -> economicAreaName), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Otras Areas: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientAnotherArea), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Cliente desde: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($data -> clientDate), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Estatus: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($status -> statusName), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Riesgo: ')); $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, utf8_decode($risk -> riskName), ''); $pdf -> Ln(); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Estatus: ')); $status = $data -> clientStatus == 1 ? 'Activo' : 'Inactivo'; $pdf -> SetFont('Arial', 'B', 9); $pdf -> Cell(165, 6, $status, ''); $pdf -> Ln(10); $pdf -> SetFont('Ubuntu', '', 9); $pdf -> Cell(30, 6, utf8_decode('Estructura Patrimonial: ')); $pdf -> Ln(10); $pdf -> Cell(15, 6, ''); $pdf -> SetFont('Ubuntu', '', 7); $pdf -> Cell(105, 6, utf8_decode('Accionistas')); $pdf -> Cell(30, 6, utf8_decode('No. Identificación'), '', '', 'C'); $pdf -> Cell(30, 6, utf8_decode('% Acciones'), '', '', 'C'); $pdf -> Ln(); $_shareholder = mysqli_query($connection, "SELECT * FROM shareholder WHERE clientId = '" . $_GET["id"] . "' ORDER BY shareholderPercent DESC"); while($shareholder = $_shareholder -> fetch_object()) { $pdf -> Cell(15, 6, ''); $pdf -> SetFont('Arial', '', 9); $pdf -> Cell(105, 6, utf8_decode($shareholder -> shareholderName), 1, '', ''); $pdf -> Cell(30, 6, utf8_decode($shareholder -> personId), 1, '', 'C'); $pdf -> Cell(30, 6, utf8_decode($shareholder -> shareholderPercent) . ' %', 1, '', 'C'); $pdf -> Ln(); }} $pdf -> Output('I', 'suscriptor.pdf', '');
